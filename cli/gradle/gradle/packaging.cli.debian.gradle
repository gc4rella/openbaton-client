/*
 * Copyright (c) 2016 Open Baton (http://www.openbaton.org)
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 */

ext {
    versionJar = version
    debianApplicationVersionFull = "${applicationVersionFull}".replaceAll("-", ".")
    openbatonInstallDir = "/opt/openbaton"
}

task makedeb(type: Deb, dependsOn: [jar, build]) { 
    packageName = (applicationRelease) ? "openbaton-cli" : "openbaton-cli-nightly"
    version = debianApplicationVersionFull
    //release = 1 
    priority = 'optional'
    arch = 'all'
    maintainer = 'Open Baton Team <dev@openbaton.org>'
    vendor = 'Open Source (Implemented by Fraunhofer FOKUS and TUB)'
    license = 'Apache 2.0 License'
    url = 'http://openbaton.github.io/index.html'
    summary = 'Command Line Interface (CLI) for the Open Baton Project'
    packageDescription = 'The Open Baton CLI is a feature of the Open Baton projetc, which is an ETSI compliant implementation of a NFV Management and Orchestration (MANO). It allows to use the Open Baton NFVO\'s API and send commands to it.'

    requires('openjdk-7-jre')

    postInstall file('gradle/gradle/scripts/debian/postinst')

    // Copy files from "from path" to "into path"
    //from('./build/libs/')                                             { into '/usr/lib/openbaton/cli' }      // all jar files
    from("./build/libs/cli-all-${versionJar}" + ".jar")                 { into '/usr/lib/openbaton/cli' }      // only cli-all jar file
    from('../nfvo.properties')                                          { into '/etc/openbaton/cli' }          // properties needed to run the CLI
    from('../openbaton.sh')                                             { 
                                                                            rename "openbaton.sh", "openbaton"
                                                                            into '/usr/bin/'}                    // executable to run the CLI
}
